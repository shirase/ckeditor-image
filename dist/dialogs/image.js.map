{"version":3,"sources":["dialogs/image.js"],"names":["imageDialog","editor","dialogType","commitContent","args","arguments","inlineStyleField","this","getContentElement","commit","apply","foreach","widget","id","commitInternally","targetFields","incommit","dialog","getDialog","element","imageElement","IMAGE","concat","field","length","i","split","setup","previewPreloader","regexGetSize","onSizeChange","value","getValue","aMatch","match","switchLockRatio","lockRatio","oImageOriginal","originalElement","getCustomData","Math","round","$","width","height","isNaN","setValueOf","updatePreview","preview","userlockRatio","getValueOf","originalRatio","thisRatio","undefined","ratioButton","CKEDITOR","document","getById","btnLockSizesId","removeClass","addClass","setAttribute","env","hc","getChild","setHtml","ie","resetSize","emptyValues","widthValue","heightValue","widthField","heightField","setValue","setupDimension","type","checkDimension","size","defaultValue","dimension","getAttribute","getStyle","onImgLoadEvent","original","loader","imagePreviewLoaderId","setCustomData","removeListener","onImgLoadErrorEvent","setStyle","dontResetSize","config","image_prefillDimensions","firstLoad","tools","setTimeout","noimage","getUrl","plugins","get","path","numbering","getNextId","btnResetSizeId","previewLinkId","previewImageId","title","lang","image","minWidth","skinName","skin","minHeight","onShow","linkElement","imageEditMode","linkEditMode","addLink","getParentEditor","sel","getSelection","getSelectedElement","link","elementPath","contains","dom","createElement","linkChildren","getChildren","count","childTag","getItem","NODE_ELEMENT","is","setupContent","customImageElement","getName","data","cleanImageElement","clone","trim","removeAttribute","onOk","imgTagName","confirm","button2Img","insertElement","img2Button","setAttributes","alt","appendTo","selectElement","equals","append","onLoad","hidePage","doc","_","getDocument","addFocusable","onHide","remove","contents","label","infoTab","accessKey","elements","padding","children","widths","align","className","common","url","required","onChange","newUrl","removeStyle","on","src","setInitValue","isChanged","validate","notEmpty","urlMissing","style","browseServer","hidden","filebrowser","default","requiredContent","onKeyUp","call","isValid","parseInt","alert","invalidWidth","activeFilter","check","cssLength","invalidHeight","resetButton","evt","preventDefault","html","border","integer","validateBorder","borderStyle","hSpace","validateHSpace","marginLeftPx","marginRightPx","marginLeftStyle","marginRightStyle","vSpace","validateVSpace","marginTopPx","marginBottomPx","marginTopStyle","marginBottomStyle","items","notSet","alignLeft","alignRight","toLowerCase","htmlEncode","image_previewText","linkTab","href","image_removeLinkByEmptyURL","action","target","filebrowserImageBrowseLinkUrl","targetNew","targetTop","targetSelf","targetParent","upload","btnUpload","buttons","fire","for","advancedTab","langDir","langDirLtr","langDirRtl","langCode","longDescr","cssClass","advisoryTitle","cssStyle","inlineStyle","invalidInlineStyle","genStyle","cssText","aMatchH","aMatchW","attributesInStyle","add"],"mappings":"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","file":"image.js","sourcesContent":["/**\n * @license Copyright (c) 2003-2017, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n( function() {\n\tvar imageDialog = function( editor, dialogType ) {\n\t\t\t// Load image preview.\n\t\t\tvar IMAGE = 1,\n\t\t\t\tLINK = 2,\n\t\t\t\tPREVIEW = 4,\n\t\t\t\tCLEANUP = 8,\n\t\t\t\tregexGetSize = /^\\s*(\\d+)((px)|\\%)?\\s*$/i,\n\t\t\t\tregexGetSizeOrEmpty = /(^\\s*(\\d+)((px)|\\%)?\\s*$)|^$/i,\n\t\t\t\tpxLengthRegex = /^\\d+px$/;\n\n\t\t\tvar onSizeChange = function() {\n\t\t\t\t\tvar value = this.getValue(),\n\t\t\t\t\t\t// This = input element.\n\t\t\t\t\t\tdialog = this.getDialog(),\n\t\t\t\t\t\taMatch = value.match( regexGetSize ); // Check value\n\t\t\t\t\tif ( aMatch ) {\n\t\t\t\t\t\tif ( aMatch[ 2 ] == '%' ) // % is allowed - > unlock ratio.\n\t\t\t\t\t\tswitchLockRatio( dialog, false ); // Unlock.\n\t\t\t\t\t\tvalue = aMatch[ 1 ];\n\t\t\t\t\t}\n\n\t\t\t\t\t// Only if ratio is locked\n\t\t\t\t\tif ( dialog.lockRatio ) {\n\t\t\t\t\t\tvar oImageOriginal = dialog.originalElement;\n\t\t\t\t\t\tif ( oImageOriginal.getCustomData( 'isReady' ) == 'true' ) {\n\t\t\t\t\t\t\tif ( this.id == 'txtHeight' ) {\n\t\t\t\t\t\t\t\tif ( value && value != '0' )\n\t\t\t\t\t\t\t\t\tvalue = Math.round( oImageOriginal.$.width * ( value / oImageOriginal.$.height ) );\n\t\t\t\t\t\t\t\tif ( !isNaN( value ) )\n\t\t\t\t\t\t\t\t\tdialog.setValueOf( 'info', 'txtWidth', value );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// this.id = txtWidth.\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tif ( value && value != '0' )\n\t\t\t\t\t\t\t\t\tvalue = Math.round( oImageOriginal.$.height * ( value / oImageOriginal.$.width ) );\n\t\t\t\t\t\t\t\tif ( !isNaN( value ) )\n\t\t\t\t\t\t\t\t\tdialog.setValueOf( 'info', 'txtHeight', value );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tupdatePreview( dialog );\n\t\t\t\t};\n\n\t\t\tvar updatePreview = function( dialog ) {\n\t\t\t\t\t//Don't load before onShow.\n\t\t\t\t\tif ( !dialog.originalElement || !dialog.preview )\n\t\t\t\t\t\treturn 1;\n\n\t\t\t\t\t// Read attributes and update imagePreview;\n\t\t\t\t\tdialog.commitContent( PREVIEW, dialog.preview );\n\t\t\t\t\treturn 0;\n\t\t\t\t};\n\n\t\t\t// Custom commit dialog logic, where we're intended to give inline style\n\t\t\t// field (txtdlgGenStyle) higher priority to avoid overwriting styles contribute\n\t\t\t// by other fields.\n\t\t\tfunction commitContent() {\n\t\t\t\tvar args = arguments;\n\t\t\t\tvar inlineStyleField = this.getContentElement( 'advanced', 'txtdlgGenStyle' );\n\t\t\t\tinlineStyleField && inlineStyleField.commit.apply( inlineStyleField, args );\n\n\t\t\t\tthis.foreach( function( widget ) {\n\t\t\t\t\tif ( widget.commit && widget.id != 'txtdlgGenStyle' )\n\t\t\t\t\t\twidget.commit.apply( widget, args );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\t// Avoid recursions.\n\t\t\tvar incommit;\n\n\t\t\t// Synchronous field values to other impacted fields is required, e.g. border\n\t\t\t// size change should alter inline-style text as well.\n\t\t\tfunction commitInternally( targetFields ) {\n\t\t\t\tif ( incommit )\n\t\t\t\t\treturn;\n\n\t\t\t\tincommit = 1;\n\n\t\t\t\tvar dialog = this.getDialog(),\n\t\t\t\t\telement = dialog.imageElement;\n\t\t\t\tif ( element ) {\n\t\t\t\t\t// Commit this field and broadcast to target fields.\n\t\t\t\t\tthis.commit( IMAGE, element );\n\n\t\t\t\t\ttargetFields = [].concat( targetFields );\n\t\t\t\t\tvar length = targetFields.length,\n\t\t\t\t\t\tfield;\n\t\t\t\t\tfor ( var i = 0; i < length; i++ ) {\n\t\t\t\t\t\tfield = dialog.getContentElement.apply( dialog, targetFields[ i ].split( ':' ) );\n\t\t\t\t\t\t// May cause recursion.\n\t\t\t\t\t\tfield && field.setup( IMAGE, element );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tincommit = 0;\n\t\t\t}\n\n\t\t\tvar switchLockRatio = function( dialog, value ) {\n\t\t\t\t\tif ( !dialog.getContentElement( 'info', 'ratioLock' ) )\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\tvar oImageOriginal = dialog.originalElement;\n\n\t\t\t\t\t// Dialog may already closed. (#5505)\n\t\t\t\t\tif ( !oImageOriginal )\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t// Check image ratio and original image ratio, but respecting user's preference.\n\t\t\t\t\tif ( value == 'check' ) {\n\t\t\t\t\t\tif ( !dialog.userlockRatio && oImageOriginal.getCustomData( 'isReady' ) == 'true' ) {\n\t\t\t\t\t\t\tvar width = dialog.getValueOf( 'info', 'txtWidth' ),\n\t\t\t\t\t\t\t\theight = dialog.getValueOf( 'info', 'txtHeight' ),\n\t\t\t\t\t\t\t\toriginalRatio = oImageOriginal.$.width * 1000 / oImageOriginal.$.height,\n\t\t\t\t\t\t\t\tthisRatio = width * 1000 / height;\n\t\t\t\t\t\t\tdialog.lockRatio = false; // Default: unlock ratio\n\n\t\t\t\t\t\t\tif ( !width && !height )\n\t\t\t\t\t\t\t\tdialog.lockRatio = true;\n\t\t\t\t\t\t\telse if ( !isNaN( originalRatio ) && !isNaN( thisRatio ) ) {\n\t\t\t\t\t\t\t\tif ( Math.round( originalRatio ) == Math.round( thisRatio ) )\n\t\t\t\t\t\t\t\t\tdialog.lockRatio = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if ( value !== undefined )\n\t\t\t\t\t\tdialog.lockRatio = value;\n\t\t\t\t\telse {\n\t\t\t\t\t\tdialog.userlockRatio = 1;\n\t\t\t\t\t\tdialog.lockRatio = !dialog.lockRatio;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar ratioButton = CKEDITOR.document.getById( btnLockSizesId );\n\t\t\t\t\tif ( dialog.lockRatio )\n\t\t\t\t\t\tratioButton.removeClass( 'cke_btn_unlocked' );\n\t\t\t\t\telse\n\t\t\t\t\t\tratioButton.addClass( 'cke_btn_unlocked' );\n\n\t\t\t\t\tratioButton.setAttribute( 'aria-checked', dialog.lockRatio );\n\n\t\t\t\t\t// Ratio button hc presentation - WHITE SQUARE / BLACK SQUARE\n\t\t\t\t\tif ( CKEDITOR.env.hc ) {\n\t\t\t\t\t\tvar icon = ratioButton.getChild( 0 );\n\t\t\t\t\t\ticon.setHtml( dialog.lockRatio ? CKEDITOR.env.ie ? '\\u25A0' : '\\u25A3' : CKEDITOR.env.ie ? '\\u25A1' : '\\u25A2' );\n\t\t\t\t\t}\n\n\t\t\t\t\treturn dialog.lockRatio;\n\t\t\t\t};\n\n\t\t\tvar resetSize = function( dialog, emptyValues ) {\n\t\t\t\t\tvar oImageOriginal = dialog.originalElement,\n\t\t\t\t\t\tready = oImageOriginal.getCustomData( 'isReady' ) == 'true';\n\n\t\t\t\t\tif ( ready ) {\n\t\t\t\t\t\tvar widthField = dialog.getContentElement( 'info', 'txtWidth' ),\n\t\t\t\t\t\t\theightField = dialog.getContentElement( 'info', 'txtHeight' ),\n\t\t\t\t\t\t\twidthValue, heightValue;\n\n\t\t\t\t\t\tif ( emptyValues ) {\n\t\t\t\t\t\t\twidthValue = 0;\n\t\t\t\t\t\t\theightValue = 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twidthValue = oImageOriginal.$.width;\n\t\t\t\t\t\t\theightValue = oImageOriginal.$.height;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twidthField && widthField.setValue( widthValue );\n\t\t\t\t\t\theightField && heightField.setValue( heightValue );\n\t\t\t\t\t}\n\t\t\t\t\tupdatePreview( dialog );\n\t\t\t\t};\n\n\t\t\tvar setupDimension = function( type, element ) {\n\t\t\t\t\tif ( type != IMAGE )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tfunction checkDimension( size, defaultValue ) {\n\t\t\t\t\t\tvar aMatch = size.match( regexGetSize );\n\t\t\t\t\t\tif ( aMatch ) {\n\t\t\t\t\t\t\t// % is allowed.\n\t\t\t\t\t\t\tif ( aMatch[ 2 ] == '%' ) {\n\t\t\t\t\t\t\t\taMatch[ 1 ] += '%';\n\t\t\t\t\t\t\t\tswitchLockRatio( dialog, false ); // Unlock ratio\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn aMatch[ 1 ];\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn defaultValue;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar dialog = this.getDialog(),\n\t\t\t\t\t\tvalue = '',\n\t\t\t\t\t\tdimension = this.id == 'txtWidth' ? 'width' : 'height',\n\t\t\t\t\t\tsize = element.getAttribute( dimension );\n\n\t\t\t\t\tif ( size )\n\t\t\t\t\t\tvalue = checkDimension( size, value );\n\t\t\t\t\tvalue = checkDimension( element.getStyle( dimension ), value );\n\n\t\t\t\t\tthis.setValue( value );\n\t\t\t\t};\n\n\t\t\tvar previewPreloader;\n\n\t\t\tvar onImgLoadEvent = function() {\n\t\t\t\t\t// Image is ready.\n\t\t\t\t\tvar original = this.originalElement,\n\t\t\t\t\t\tloader = CKEDITOR.document.getById( imagePreviewLoaderId );\n\n\t\t\t\t\toriginal.setCustomData( 'isReady', 'true' );\n\t\t\t\t\toriginal.removeListener( 'load', onImgLoadEvent );\n\t\t\t\t\toriginal.removeListener( 'error', onImgLoadErrorEvent );\n\t\t\t\t\toriginal.removeListener( 'abort', onImgLoadErrorEvent );\n\n\t\t\t\t\t// Hide loader.\n\t\t\t\t\tif ( loader )\n\t\t\t\t\t\tloader.setStyle( 'display', 'none' );\n\n\t\t\t\t\t// New image -> new dimensions\n\t\t\t\t\tif ( !this.dontResetSize ) {\n\t\t\t\t\t\tresetSize( this, editor.config.image_prefillDimensions === false );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.firstLoad ) {\n\t\t\t\t\t\tCKEDITOR.tools.setTimeout( function() {\n\t\t\t\t\t\t\tswitchLockRatio( this, 'check' );\n\t\t\t\t\t\t}, 0, this );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.firstLoad = false;\n\t\t\t\t\tthis.dontResetSize = false;\n\n\t\t\t\t\t// Possible fix for #12818.\n\t\t\t\t\tupdatePreview( this );\n\t\t\t\t};\n\n\t\t\tvar onImgLoadErrorEvent = function() {\n\t\t\t\t\t// Error. Image is not loaded.\n\t\t\t\t\tvar original = this.originalElement,\n\t\t\t\t\t\tloader = CKEDITOR.document.getById( imagePreviewLoaderId );\n\n\t\t\t\t\toriginal.removeListener( 'load', onImgLoadEvent );\n\t\t\t\t\toriginal.removeListener( 'error', onImgLoadErrorEvent );\n\t\t\t\t\toriginal.removeListener( 'abort', onImgLoadErrorEvent );\n\n\t\t\t\t\t// Set Error image.\n\t\t\t\t\tvar noimage = CKEDITOR.getUrl( CKEDITOR.plugins.get( 'image' ).path + 'images/noimage.png' );\n\n\t\t\t\t\tif ( this.preview )\n\t\t\t\t\t\tthis.preview.setAttribute( 'src', noimage );\n\n\t\t\t\t\t// Hide loader.\n\t\t\t\t\tif ( loader )\n\t\t\t\t\t\tloader.setStyle( 'display', 'none' );\n\n\t\t\t\t\tswitchLockRatio( this, false ); // Unlock.\n\t\t\t\t};\n\n\t\t\tvar numbering = function( id ) {\n\t\t\t\t\treturn CKEDITOR.tools.getNextId() + '_' + id;\n\t\t\t\t},\n\t\t\t\tbtnLockSizesId = numbering( 'btnLockSizes' ),\n\t\t\t\tbtnResetSizeId = numbering( 'btnResetSize' ),\n\t\t\t\timagePreviewLoaderId = numbering( 'ImagePreviewLoader' ),\n\t\t\t\tpreviewLinkId = numbering( 'previewLink' ),\n\t\t\t\tpreviewImageId = numbering( 'previewImage' );\n\n\t\t\treturn {\n\t\t\t\ttitle: editor.lang.image[ dialogType == 'image' ? 'title' : 'titleButton' ],\n\t\t\t\tminWidth: ( CKEDITOR.skinName || editor.config.skin ) == 'moono-lisa' ? 500 : 420,\n\t\t\t\tminHeight: 360,\n\t\t\t\tonShow: function() {\n\t\t\t\t\tthis.imageElement = false;\n\t\t\t\t\tthis.linkElement = false;\n\n\t\t\t\t\t// Default: create a new element.\n\t\t\t\t\tthis.imageEditMode = false;\n\t\t\t\t\tthis.linkEditMode = false;\n\n\t\t\t\t\tthis.lockRatio = true;\n\t\t\t\t\tthis.userlockRatio = 0;\n\t\t\t\t\tthis.dontResetSize = false;\n\t\t\t\t\tthis.firstLoad = true;\n\t\t\t\t\tthis.addLink = false;\n\n\t\t\t\t\tvar editor = this.getParentEditor(),\n\t\t\t\t\t\tsel = editor.getSelection(),\n\t\t\t\t\t\telement = sel && sel.getSelectedElement(),\n\t\t\t\t\t\tlink = element && editor.elementPath( element ).contains( 'a', 1 ),\n\t\t\t\t\t\tloader = CKEDITOR.document.getById( imagePreviewLoaderId );\n\n\t\t\t\t\t// Hide loader.\n\t\t\t\t\tif ( loader )\n\t\t\t\t\t\tloader.setStyle( 'display', 'none' );\n\n\t\t\t\t\t// Create the preview before setup the dialog contents.\n\t\t\t\t\tpreviewPreloader = new CKEDITOR.dom.element( 'img', editor.document );\n\t\t\t\t\tthis.preview = CKEDITOR.document.getById( previewImageId );\n\n\t\t\t\t\t// Copy of the image\n\t\t\t\t\tthis.originalElement = editor.document.createElement( 'img' );\n\t\t\t\t\tthis.originalElement.setAttribute( 'alt', '' );\n\t\t\t\t\tthis.originalElement.setCustomData( 'isReady', 'false' );\n\n\t\t\t\t\tif ( link ) {\n\t\t\t\t\t\tthis.linkElement = link;\n\t\t\t\t\t\tthis.linkEditMode = true;\n\n\t\t\t\t\t\t// If there is an existing link, by default keep it (true).\n\t\t\t\t\t\t// It will be removed if certain conditions are met and Link tab is enabled. (#13351)\n\t\t\t\t\t\tthis.addLink = true;\n\n\t\t\t\t\t\t// Look for Image element.\n\t\t\t\t\t\tvar linkChildren = link.getChildren();\n\t\t\t\t\t\tif ( linkChildren.count() == 1 ) {\n\t\t\t\t\t\t\tvar childTag = linkChildren.getItem( 0 );\n\n\t\t\t\t\t\t\tif ( childTag.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\t\t\t\tif ( childTag.is( 'img' ) || childTag.is( 'input' ) ) {\n\t\t\t\t\t\t\t\t\tthis.imageElement = linkChildren.getItem( 0 );\n\t\t\t\t\t\t\t\t\tif ( this.imageElement.is( 'img' ) )\n\t\t\t\t\t\t\t\t\t\tthis.imageEditMode = 'img';\n\t\t\t\t\t\t\t\t\telse if ( this.imageElement.is( 'input' ) )\n\t\t\t\t\t\t\t\t\t\tthis.imageEditMode = 'input';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Fill out all fields.\n\t\t\t\t\t\tif ( dialogType == 'image' )\n\t\t\t\t\t\t\tthis.setupContent( LINK, link );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Edit given image element instead the one from selection.\n\t\t\t\t\tif ( this.customImageElement ) {\n\t\t\t\t\t\tthis.imageEditMode = 'img';\n\t\t\t\t\t\tthis.imageElement = this.customImageElement;\n\t\t\t\t\t\tdelete this.customImageElement;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( element && element.getName() == 'img' && !element.data( 'cke-realelement' ) ||\n\t\t\t\t\t\telement && element.getName() == 'input' && element.getAttribute( 'type' ) == 'image' ) {\n\t\t\t\t\t\tthis.imageEditMode = element.getName();\n\t\t\t\t\t\tthis.imageElement = element;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.imageEditMode ) {\n\t\t\t\t\t\t// Use the original element as a buffer from  since we don't want\n\t\t\t\t\t\t// temporary changes to be committed, e.g. if the dialog is canceled.\n\t\t\t\t\t\tthis.cleanImageElement = this.imageElement;\n\t\t\t\t\t\tthis.imageElement = this.cleanImageElement.clone( true, true );\n\n\t\t\t\t\t\t// Fill out all fields.\n\t\t\t\t\t\tthis.setupContent( IMAGE, this.imageElement );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Refresh LockRatio button\n\t\t\t\t\tswitchLockRatio( this, true );\n\n\t\t\t\t\t// Dont show preview if no URL given.\n\t\t\t\t\tif ( !CKEDITOR.tools.trim( this.getValueOf( 'info', 'txtUrl' ) ) ) {\n\t\t\t\t\t\tthis.preview.removeAttribute( 'src' );\n\t\t\t\t\t\tthis.preview.setStyle( 'display', 'none' );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonOk: function() {\n\t\t\t\t\t// Edit existing Image.\n\t\t\t\t\tif ( this.imageEditMode ) {\n\t\t\t\t\t\tvar imgTagName = this.imageEditMode;\n\n\t\t\t\t\t\t// Image dialog and Input element.\n\t\t\t\t\t\tif ( dialogType == 'image' && imgTagName == 'input' && confirm( editor.lang.image.button2Img ) ) { // jshint ignore:line\n\t\t\t\t\t\t\t// Replace INPUT-> IMG\n\t\t\t\t\t\t\timgTagName = 'img';\n\t\t\t\t\t\t\tthis.imageElement = editor.document.createElement( 'img' );\n\t\t\t\t\t\t\tthis.imageElement.setAttribute( 'alt', '' );\n\t\t\t\t\t\t\teditor.insertElement( this.imageElement );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// ImageButton dialog and Image element.\n\t\t\t\t\t\telse if ( dialogType != 'image' && imgTagName == 'img' && confirm( editor.lang.image.img2Button ) ) { // jshint ignore:line\n\t\t\t\t\t\t\t// Replace IMG -> INPUT\n\t\t\t\t\t\t\timgTagName = 'input';\n\t\t\t\t\t\t\tthis.imageElement = editor.document.createElement( 'input' );\n\t\t\t\t\t\t\tthis.imageElement.setAttributes( {\n\t\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\t\talt: ''\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\teditor.insertElement( this.imageElement );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Restore the original element before all commits.\n\t\t\t\t\t\t\tthis.imageElement = this.cleanImageElement;\n\t\t\t\t\t\t\tdelete this.cleanImageElement;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Create a new image.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Image dialog -> create IMG element.\n\t\t\t\t\t\tif ( dialogType == 'image' )\n\t\t\t\t\t\t\tthis.imageElement = editor.document.createElement( 'img' );\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.imageElement = editor.document.createElement( 'input' );\n\t\t\t\t\t\t\tthis.imageElement.setAttribute( 'type', 'image' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.imageElement.setAttribute( 'alt', '' );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Create a new link.\n\t\t\t\t\tif ( !this.linkEditMode )\n\t\t\t\t\t\tthis.linkElement = editor.document.createElement( 'a' );\n\n\t\t\t\t\t// Set attributes.\n\t\t\t\t\tthis.commitContent( IMAGE, this.imageElement );\n\t\t\t\t\tthis.commitContent( LINK, this.linkElement );\n\n\t\t\t\t\t// Remove empty style attribute.\n\t\t\t\t\tif ( !this.imageElement.getAttribute( 'style' ) )\n\t\t\t\t\t\tthis.imageElement.removeAttribute( 'style' );\n\n\t\t\t\t\t// Insert a new Image.\n\t\t\t\t\tif ( !this.imageEditMode ) {\n\t\t\t\t\t\tif ( this.addLink ) {\n\t\t\t\t\t\t\tif ( !this.linkEditMode ) {\n\t\t\t\t\t\t\t\t// Insert a new link.\n\t\t\t\t\t\t\t\teditor.insertElement( this.linkElement );\n\t\t\t\t\t\t\t\tthis.linkElement.append( this.imageElement, false );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// We already have a link in editor.\n\t\t\t\t\t\t\t\tif ( this.linkElement.equals( editor.getSelection().getSelectedElement() ) ) {\n\t\t\t\t\t\t\t\t\t// If the link is selected outside, replace it's content rather than the link itself. ([<a>foo</a>])\n\t\t\t\t\t\t\t\t\tthis.linkElement.setHtml( '' );\n\t\t\t\t\t\t\t\t\tthis.linkElement.append( this.imageElement, false );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// Only inside of the link is selected, so replace it with image. (<a>[foo]</a>, <a>[f]oo</a>)\n\t\t\t\t\t\t\t\t\teditor.insertElement( this.imageElement );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\teditor.insertElement( this.imageElement );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Image already exists.\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Add a new link element.\n\t\t\t\t\t\tif ( !this.linkEditMode && this.addLink ) {\n\t\t\t\t\t\t\teditor.insertElement( this.linkElement );\n\t\t\t\t\t\t\tthis.imageElement.appendTo( this.linkElement );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Remove Link, Image exists.\n\t\t\t\t\t\telse if ( this.linkEditMode && !this.addLink ) {\n\t\t\t\t\t\t\teditor.getSelection().selectElement( this.linkElement );\n\t\t\t\t\t\t\teditor.insertElement( this.imageElement );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonLoad: function() {\n\t\t\t\t\tif ( dialogType != 'image' )\n\t\t\t\t\t\tthis.hidePage( 'Link' ); //Hide Link tab.\n\t\t\t\t\tvar doc = this._.element.getDocument();\n\n\t\t\t\t\tif ( this.getContentElement( 'info', 'ratioLock' ) ) {\n\t\t\t\t\t\tthis.addFocusable( doc.getById( btnResetSizeId ), 5 );\n\t\t\t\t\t\tthis.addFocusable( doc.getById( btnLockSizesId ), 5 );\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.commitContent = commitContent;\n\t\t\t\t},\n\t\t\t\tonHide: function() {\n\t\t\t\t\tif ( this.preview )\n\t\t\t\t\t\tthis.commitContent( CLEANUP, this.preview );\n\n\t\t\t\t\tif ( this.originalElement ) {\n\t\t\t\t\t\tthis.originalElement.removeListener( 'load', onImgLoadEvent );\n\t\t\t\t\t\tthis.originalElement.removeListener( 'error', onImgLoadErrorEvent );\n\t\t\t\t\t\tthis.originalElement.removeListener( 'abort', onImgLoadErrorEvent );\n\t\t\t\t\t\tthis.originalElement.remove();\n\t\t\t\t\t\tthis.originalElement = false; // Dialog is closed.\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete this.imageElement;\n\t\t\t\t},\n\t\t\t\tcontents: [ {\n\t\t\t\t\tid: 'info',\n\t\t\t\t\tlabel: editor.lang.image.infoTab,\n\t\t\t\t\taccessKey: 'I',\n\t\t\t\t\telements: [ {\n\t\t\t\t\t\ttype: 'vbox',\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\ttype: 'hbox',\n\t\t\t\t\t\t\twidths: [ '280px', '110px' ],\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tclassName: 'cke_dialog_image_url',\n\t\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\t\tid: 'txtUrl',\n\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\tlabel: editor.lang.common.url,\n\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\tvar dialog = this.getDialog(),\n\t\t\t\t\t\t\t\t\t\tnewUrl = this.getValue();\n\n\t\t\t\t\t\t\t\t\t// Update original image.\n\t\t\t\t\t\t\t\t\t// Prevent from load before onShow.\n\t\t\t\t\t\t\t\t\tif ( newUrl.length > 0 ) {\n\t\t\t\t\t\t\t\t\t\tdialog = this.getDialog();\n\t\t\t\t\t\t\t\t\t\tvar original = dialog.originalElement;\n\n\t\t\t\t\t\t\t\t\t\tif ( dialog.preview ) {\n\t\t\t\t\t\t\t\t\t\t\tdialog.preview.removeStyle( 'display' );\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\toriginal.setCustomData( 'isReady', 'false' );\n\t\t\t\t\t\t\t\t\t\t// Show loader.\n\t\t\t\t\t\t\t\t\t\tvar loader = CKEDITOR.document.getById( imagePreviewLoaderId );\n\t\t\t\t\t\t\t\t\t\tif ( loader )\n\t\t\t\t\t\t\t\t\t\t\tloader.setStyle( 'display', '' );\n\n\t\t\t\t\t\t\t\t\t\toriginal.on( 'load', onImgLoadEvent, dialog );\n\t\t\t\t\t\t\t\t\t\toriginal.on( 'error', onImgLoadErrorEvent, dialog );\n\t\t\t\t\t\t\t\t\t\toriginal.on( 'abort', onImgLoadErrorEvent, dialog );\n\t\t\t\t\t\t\t\t\t\toriginal.setAttribute( 'src', newUrl );\n\n\t\t\t\t\t\t\t\t\t\tif ( dialog.preview ) {\n\t\t\t\t\t\t\t\t\t\t\t// Query the preloader to figure out the url impacted by based href.\n\t\t\t\t\t\t\t\t\t\t\tpreviewPreloader.setAttribute( 'src', newUrl );\n\t\t\t\t\t\t\t\t\t\t\tdialog.preview.setAttribute( 'src', previewPreloader.$.src );\n\t\t\t\t\t\t\t\t\t\t\tupdatePreview( dialog );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// Dont show preview if no URL given.\n\t\t\t\t\t\t\t\t\telse if ( dialog.preview ) {\n\t\t\t\t\t\t\t\t\t\tdialog.preview.removeAttribute( 'src' );\n\t\t\t\t\t\t\t\t\t\tdialog.preview.setStyle( 'display', 'none' );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\tvar url = element.data( 'cke-saved-src' ) || element.getAttribute( 'src' );\n\t\t\t\t\t\t\t\t\t\tvar field = this;\n\n\t\t\t\t\t\t\t\t\t\tthis.getDialog().dontResetSize = true;\n\n\t\t\t\t\t\t\t\t\t\tfield.setValue( url ); // And call this.onChange()\n\t\t\t\t\t\t\t\t\t\t// Manually set the initial value.(#4191)\n\t\t\t\t\t\t\t\t\t\tfield.setInitValue();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\t\tif ( type == IMAGE && ( this.getValue() || this.isChanged() ) ) {\n\t\t\t\t\t\t\t\t\t\telement.data( 'cke-saved-src', this.getValue() );\n\t\t\t\t\t\t\t\t\t\telement.setAttribute( 'src', this.getValue() );\n\t\t\t\t\t\t\t\t\t} else if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\t\telement.setAttribute( 'src', '' ); // If removeAttribute doesn't work.\n\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'src' );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tvalidate: CKEDITOR.dialog.validate.notEmpty( editor.lang.image.urlMissing )\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'button',\n\t\t\t\t\t\t\t\tid: 'browse',\n\t\t\t\t\t\t\t\t// v-align with the 'txtUrl' field.\n\t\t\t\t\t\t\t\t// TODO: We need something better than a fixed size here.\n\t\t\t\t\t\t\t\tstyle: 'display:inline-block;margin-top:14px;',\n\t\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\t\tlabel: editor.lang.common.browseServer,\n\t\t\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\t\t\tfilebrowser: 'info:txtUrl'\n\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t} ]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'txtAlt',\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tlabel: editor.lang.image.alt,\n\t\t\t\t\t\taccessKey: 'T',\n\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\tupdatePreview( this.getDialog() );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'alt' ) );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\telement.setAttribute( 'alt', this.getValue() );\n\t\t\t\t\t\t\t} else if ( type == PREVIEW )\n\t\t\t\t\t\t\t\telement.setAttribute( 'alt', this.getValue() );\n\t\t\t\t\t\t\telse if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\telement.removeAttribute( 'alt' );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'hbox',\n\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\tid: 'basic',\n\t\t\t\t\t\t\ttype: 'vbox',\n\t\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\t\ttype: 'hbox',\n\t\t\t\t\t\t\t\trequiredContent: 'img{width,height}',\n\t\t\t\t\t\t\t\twidths: [ '50%', '50%' ],\n\t\t\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\t\t\ttype: 'vbox',\n\t\t\t\t\t\t\t\t\tpadding: 1,\n\t\t\t\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\t\twidth: '45px',\n\t\t\t\t\t\t\t\t\t\tid: 'txtWidth',\n\t\t\t\t\t\t\t\t\t\tlabel: editor.lang.common.width,\n\t\t\t\t\t\t\t\t\t\tonKeyUp: onSizeChange,\n\t\t\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\t\t\tcommitInternally.call( this, 'advanced:txtdlgGenStyle' );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tvalidate: function() {\n\t\t\t\t\t\t\t\t\t\t\tvar aMatch = this.getValue().match( regexGetSizeOrEmpty ),\n\t\t\t\t\t\t\t\t\t\t\t\tisValid = !!( aMatch && parseInt( aMatch[ 1 ], 10 ) !== 0 );\n\t\t\t\t\t\t\t\t\t\t\tif ( !isValid )\n\t\t\t\t\t\t\t\t\t\t\t\talert( editor.lang.common.invalidWidth ); // jshint ignore:line\n\t\t\t\t\t\t\t\t\t\t\treturn isValid;\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tsetup: setupDimension,\n\t\t\t\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\t\tvar value = this.getValue();\n\t\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\t\t\tif ( value && editor.activeFilter.check( 'img{width,height}' ) )\n\t\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'width', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'width' );\n\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'width' );\n\t\t\t\t\t\t\t\t\t\t\t} else if ( type == PREVIEW ) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar aMatch = value.match( regexGetSize );\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !aMatch ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar oImageOriginal = this.getDialog().originalElement;\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( oImageOriginal.getCustomData( 'isReady' ) == 'true' )\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'width', oImageOriginal.$.width + 'px' );\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'width', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t} else if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'width' );\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'width' );\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\t\tid: 'txtHeight',\n\t\t\t\t\t\t\t\t\t\twidth: '45px',\n\t\t\t\t\t\t\t\t\t\tlabel: editor.lang.common.height,\n\t\t\t\t\t\t\t\t\t\tonKeyUp: onSizeChange,\n\t\t\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\t\t\tcommitInternally.call( this, 'advanced:txtdlgGenStyle' );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tvalidate: function() {\n\t\t\t\t\t\t\t\t\t\t\tvar aMatch = this.getValue().match( regexGetSizeOrEmpty ),\n\t\t\t\t\t\t\t\t\t\t\t\tisValid = !!( aMatch && parseInt( aMatch[ 1 ], 10 ) !== 0 );\n\t\t\t\t\t\t\t\t\t\t\tif ( !isValid )\n\t\t\t\t\t\t\t\t\t\t\t\talert( editor.lang.common.invalidHeight ); // jshint ignore:line\n\t\t\t\t\t\t\t\t\t\t\treturn isValid;\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tsetup: setupDimension,\n\t\t\t\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\t\tvar value = this.getValue();\n\t\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\t\t\tif ( value && editor.activeFilter.check( 'img{width,height}' ) )\n\t\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'height', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'height' );\n\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'height' );\n\t\t\t\t\t\t\t\t\t\t\t} else if ( type == PREVIEW ) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar aMatch = value.match( regexGetSize );\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !aMatch ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar oImageOriginal = this.getDialog().originalElement;\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( oImageOriginal.getCustomData( 'isReady' ) == 'true' )\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'height', oImageOriginal.$.height + 'px' );\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'height', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t} else if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'height' );\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'height' );\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: 'ratioLock',\n\t\t\t\t\t\t\t\t\ttype: 'html',\n\t\t\t\t\t\t\t\t\tclassName: 'cke_dialog_image_ratiolock',\n\t\t\t\t\t\t\t\t\tstyle: 'margin-top:30px;width:40px;height:40px;',\n\t\t\t\t\t\t\t\t\tonLoad: function() {\n\t\t\t\t\t\t\t\t\t\t// Activate Reset button\n\t\t\t\t\t\t\t\t\t\tvar resetButton = CKEDITOR.document.getById( btnResetSizeId ),\n\t\t\t\t\t\t\t\t\t\t\tratioButton = CKEDITOR.document.getById( btnLockSizesId );\n\t\t\t\t\t\t\t\t\t\tif ( resetButton ) {\n\t\t\t\t\t\t\t\t\t\t\tresetButton.on( 'click', function( evt ) {\n\t\t\t\t\t\t\t\t\t\t\t\tresetSize( this );\n\t\t\t\t\t\t\t\t\t\t\t\tevt.data && evt.data.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t}, this.getDialog() );\n\t\t\t\t\t\t\t\t\t\t\tresetButton.on( 'mouseover', function() {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.addClass( 'cke_btn_over' );\n\t\t\t\t\t\t\t\t\t\t\t}, resetButton );\n\t\t\t\t\t\t\t\t\t\t\tresetButton.on( 'mouseout', function() {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.removeClass( 'cke_btn_over' );\n\t\t\t\t\t\t\t\t\t\t\t}, resetButton );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t// Activate (Un)LockRatio button\n\t\t\t\t\t\t\t\t\t\tif ( ratioButton ) {\n\t\t\t\t\t\t\t\t\t\t\tratioButton.on( 'click', function( evt ) {\n\t\t\t\t\t\t\t\t\t\t\t\tswitchLockRatio( this );\n\n\t\t\t\t\t\t\t\t\t\t\t\tvar oImageOriginal = this.originalElement,\n\t\t\t\t\t\t\t\t\t\t\t\t\twidth = this.getValueOf( 'info', 'txtWidth' );\n\n\t\t\t\t\t\t\t\t\t\t\t\tif ( oImageOriginal.getCustomData( 'isReady' ) == 'true' && width ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar height = oImageOriginal.$.height / oImageOriginal.$.width * width;\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( !isNaN( height ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.setValueOf( 'info', 'txtHeight', Math.round( height ) );\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tupdatePreview( this );\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tevt.data && evt.data.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t}, this.getDialog() );\n\t\t\t\t\t\t\t\t\t\t\tratioButton.on( 'mouseover', function() {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.addClass( 'cke_btn_over' );\n\t\t\t\t\t\t\t\t\t\t\t}, ratioButton );\n\t\t\t\t\t\t\t\t\t\t\tratioButton.on( 'mouseout', function() {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.removeClass( 'cke_btn_over' );\n\t\t\t\t\t\t\t\t\t\t\t}, ratioButton );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\thtml: '<div>' +\n\t\t\t\t\t\t\t\t\t\t'<a href=\"javascript:void(0)\" tabindex=\"-1\" title=\"' + editor.lang.image.lockRatio +\n\t\t\t\t\t\t\t\t\t\t'\" class=\"cke_btn_locked\" id=\"' + btnLockSizesId + '\" role=\"checkbox\"><span class=\"cke_icon\"></span><span class=\"cke_label\">' + editor.lang.image.lockRatio + '</span></a>' +\n\t\t\t\t\t\t\t\t\t\t'<a href=\"javascript:void(0)\" tabindex=\"-1\" title=\"' + editor.lang.image.resetSize +\n\t\t\t\t\t\t\t\t\t\t'\" class=\"cke_btn_reset\" id=\"' + btnResetSizeId + '\" role=\"button\"><span class=\"cke_label\">' + editor.lang.image.resetSize + '</span></a>' +\n\t\t\t\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'vbox',\n\t\t\t\t\t\t\t\tpadding: 1,\n\t\t\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\tid: 'txtBorder',\n\t\t\t\t\t\t\t\t\trequiredContent: 'img{border-width}',\n\t\t\t\t\t\t\t\t\twidth: '60px',\n\t\t\t\t\t\t\t\t\tlabel: editor.lang.image.border,\n\t\t\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\t\t\tonKeyUp: function() {\n\t\t\t\t\t\t\t\t\t\tupdatePreview( this.getDialog() );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\t\tcommitInternally.call( this, 'advanced:txtdlgGenStyle' );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tvalidate: CKEDITOR.dialog.validate.integer( editor.lang.image.validateBorder ),\n\t\t\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\t\tvar value,\n\t\t\t\t\t\t\t\t\t\t\t\tborderStyle = element.getStyle( 'border-width' );\n\t\t\t\t\t\t\t\t\t\t\tborderStyle = borderStyle && borderStyle.match( /^(\\d+px)(?: \\1 \\1 \\1)?$/ );\n\t\t\t\t\t\t\t\t\t\t\tvalue = borderStyle && parseInt( borderStyle[ 1 ], 10 );\n\t\t\t\t\t\t\t\t\t\t\tisNaN( parseInt( value, 10 ) ) && ( value = element.getAttribute( 'border' ) );\n\t\t\t\t\t\t\t\t\t\t\tthis.setValue( value );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tvar value = parseInt( this.getValue(), 10 );\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE || type == PREVIEW ) {\n\t\t\t\t\t\t\t\t\t\t\tif ( !isNaN( value ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'border-width', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'border-style', 'solid' );\n\t\t\t\t\t\t\t\t\t\t\t} else if ( !value && this.isChanged() ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'border' );\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'border' );\n\t\t\t\t\t\t\t\t\t\t} else if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'border' );\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'border-width' );\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'border-style' );\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'border-color' );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\tid: 'txtHSpace',\n\t\t\t\t\t\t\t\t\trequiredContent: 'img{margin-left,margin-right}',\n\t\t\t\t\t\t\t\t\twidth: '60px',\n\t\t\t\t\t\t\t\t\tlabel: editor.lang.image.hSpace,\n\t\t\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\t\t\tonKeyUp: function() {\n\t\t\t\t\t\t\t\t\t\tupdatePreview( this.getDialog() );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\t\tcommitInternally.call( this, 'advanced:txtdlgGenStyle' );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tvalidate: CKEDITOR.dialog.validate.integer( editor.lang.image.validateHSpace ),\n\t\t\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\t\tvar value, marginLeftPx, marginRightPx,\n\t\t\t\t\t\t\t\t\t\t\t\tmarginLeftStyle = element.getStyle( 'margin-left' ),\n\t\t\t\t\t\t\t\t\t\t\t\tmarginRightStyle = element.getStyle( 'margin-right' );\n\n\t\t\t\t\t\t\t\t\t\t\tmarginLeftStyle = marginLeftStyle && marginLeftStyle.match( pxLengthRegex );\n\t\t\t\t\t\t\t\t\t\t\tmarginRightStyle = marginRightStyle && marginRightStyle.match( pxLengthRegex );\n\t\t\t\t\t\t\t\t\t\t\tmarginLeftPx = parseInt( marginLeftStyle, 10 );\n\t\t\t\t\t\t\t\t\t\t\tmarginRightPx = parseInt( marginRightStyle, 10 );\n\n\t\t\t\t\t\t\t\t\t\t\tvalue = ( marginLeftPx == marginRightPx ) && marginLeftPx;\n\t\t\t\t\t\t\t\t\t\t\tisNaN( parseInt( value, 10 ) ) && ( value = element.getAttribute( 'hspace' ) );\n\n\t\t\t\t\t\t\t\t\t\t\tthis.setValue( value );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tvar value = parseInt( this.getValue(), 10 );\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE || type == PREVIEW ) {\n\t\t\t\t\t\t\t\t\t\t\tif ( !isNaN( value ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'margin-left', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'margin-right', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t} else if ( !value && this.isChanged() ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-left' );\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-right' );\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'hspace' );\n\t\t\t\t\t\t\t\t\t\t} else if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'hspace' );\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-left' );\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-right' );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\tid: 'txtVSpace',\n\t\t\t\t\t\t\t\t\trequiredContent: 'img{margin-top,margin-bottom}',\n\t\t\t\t\t\t\t\t\twidth: '60px',\n\t\t\t\t\t\t\t\t\tlabel: editor.lang.image.vSpace,\n\t\t\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\t\t\tonKeyUp: function() {\n\t\t\t\t\t\t\t\t\t\tupdatePreview( this.getDialog() );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\t\tcommitInternally.call( this, 'advanced:txtdlgGenStyle' );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tvalidate: CKEDITOR.dialog.validate.integer( editor.lang.image.validateVSpace ),\n\t\t\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\t\tvar value, marginTopPx, marginBottomPx,\n\t\t\t\t\t\t\t\t\t\t\t\tmarginTopStyle = element.getStyle( 'margin-top' ),\n\t\t\t\t\t\t\t\t\t\t\t\tmarginBottomStyle = element.getStyle( 'margin-bottom' );\n\n\t\t\t\t\t\t\t\t\t\t\tmarginTopStyle = marginTopStyle && marginTopStyle.match( pxLengthRegex );\n\t\t\t\t\t\t\t\t\t\t\tmarginBottomStyle = marginBottomStyle && marginBottomStyle.match( pxLengthRegex );\n\t\t\t\t\t\t\t\t\t\t\tmarginTopPx = parseInt( marginTopStyle, 10 );\n\t\t\t\t\t\t\t\t\t\t\tmarginBottomPx = parseInt( marginBottomStyle, 10 );\n\n\t\t\t\t\t\t\t\t\t\t\tvalue = ( marginTopPx == marginBottomPx ) && marginTopPx;\n\t\t\t\t\t\t\t\t\t\t\tisNaN( parseInt( value, 10 ) ) && ( value = element.getAttribute( 'vspace' ) );\n\t\t\t\t\t\t\t\t\t\t\tthis.setValue( value );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tvar value = parseInt( this.getValue(), 10 );\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE || type == PREVIEW ) {\n\t\t\t\t\t\t\t\t\t\t\tif ( !isNaN( value ) ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'margin-top', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'margin-bottom', CKEDITOR.tools.cssLength( value ) );\n\t\t\t\t\t\t\t\t\t\t\t} else if ( !value && this.isChanged() ) {\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-top' );\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-bottom' );\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'vspace' );\n\t\t\t\t\t\t\t\t\t\t} else if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'vspace' );\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-top' );\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'margin-bottom' );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: 'cmbAlign',\n\t\t\t\t\t\t\t\t\trequiredContent: 'img{float}',\n\t\t\t\t\t\t\t\t\ttype: 'select',\n\t\t\t\t\t\t\t\t\twidths: [ '35%', '65%' ],\n\t\t\t\t\t\t\t\t\tstyle: 'width:90px',\n\t\t\t\t\t\t\t\t\tlabel: editor.lang.common.align,\n\t\t\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\t\t[ editor.lang.common.notSet, '' ],\n\t\t\t\t\t\t\t\t\t\t[ editor.lang.common.alignLeft, 'left' ],\n\t\t\t\t\t\t\t\t\t\t[ editor.lang.common.alignRight, 'right' ]\n\t\t\t\t\t\t\t\t\t\t// Backward compatible with v2 on setup when specified as attribute value,\n\t\t\t\t\t\t\t\t\t\t// while these values are no more available as select options.\n\t\t\t\t\t\t\t\t\t\t//\t[ editor.lang.image.alignAbsBottom , 'absBottom'],\n\t\t\t\t\t\t\t\t\t\t//\t[ editor.lang.image.alignAbsMiddle , 'absMiddle'],\n\t\t\t\t\t\t\t\t\t\t//  [ editor.lang.image.alignBaseline , 'baseline'],\n\t\t\t\t\t\t\t\t\t\t//  [ editor.lang.image.alignTextTop , 'text-top'],\n\t\t\t\t\t\t\t\t\t\t//  [ editor.lang.image.alignBottom , 'bottom'],\n\t\t\t\t\t\t\t\t\t\t//  [ editor.lang.image.alignMiddle , 'middle'],\n\t\t\t\t\t\t\t\t\t\t//  [ editor.lang.image.alignTop , 'top']\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\t\t\tupdatePreview( this.getDialog() );\n\t\t\t\t\t\t\t\t\t\tcommitInternally.call( this, 'advanced:txtdlgGenStyle' );\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\t\tvar value = element.getStyle( 'float' );\n\t\t\t\t\t\t\t\t\t\t\tswitch ( value ) {\n\t\t\t\t\t\t\t\t\t\t\t\t// Ignore those unrelated values.\n\t\t\t\t\t\t\t\t\t\t\t\tcase 'inherit':\n\t\t\t\t\t\t\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue = '';\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t!value && ( value = ( element.getAttribute( 'align' ) || '' ).toLowerCase() );\n\t\t\t\t\t\t\t\t\t\t\tthis.setValue( value );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\t\t\tvar value = this.getValue();\n\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE || type == PREVIEW ) {\n\t\t\t\t\t\t\t\t\t\t\tif ( value )\n\t\t\t\t\t\t\t\t\t\t\t\telement.setStyle( 'float', value );\n\t\t\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'float' );\n\n\t\t\t\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\t\t\t\tvalue = ( element.getAttribute( 'align' ) || '' ).toLowerCase();\n\t\t\t\t\t\t\t\t\t\t\t\tswitch ( value ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t// we should remove it only if it matches \"left\" or \"right\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t// otherwise leave it intact.\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\t\t\t\t\t\t\t\telement.removeAttribute( 'align' );\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\t\t\telement.removeStyle( 'float' );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'vbox',\n\t\t\t\t\t\t\theight: '250px',\n\t\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\t\ttype: 'html',\n\t\t\t\t\t\t\t\tid: 'htmlPreview',\n\t\t\t\t\t\t\t\tstyle: 'width:95%;',\n\t\t\t\t\t\t\t\thtml: '<div>' + CKEDITOR.tools.htmlEncode( editor.lang.common.preview ) + '<br>' +\n\t\t\t\t\t\t\t\t\t'<div id=\"' + imagePreviewLoaderId + '\" class=\"ImagePreviewLoader\" style=\"display:none\"><div class=\"loading\">&nbsp;</div></div>' +\n\t\t\t\t\t\t\t\t\t'<div class=\"ImagePreviewBox\"><table><tr><td>' +\n\t\t\t\t\t\t\t\t\t\t'<a href=\"javascript:void(0)\" target=\"_blank\" onclick=\"return false;\" id=\"' + previewLinkId + '\">' +\n\t\t\t\t\t\t\t\t\t\t'<img id=\"' + previewImageId + '\" alt=\"\" /></a>' +\n\t\t\t\t\t\t\t\t\t// jscs:disable maximumLineLength\n\t\t\t\t\t\t\t\t\t\t( editor.config.image_previewText || 'Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ' +\n\t\t\t\t\t\t\t\t\t\t\t'Maecenas feugiat consequat diam. Maecenas metus. Vivamus diam purus, cursus a, commodo non, facilisis vitae, ' +\n\t\t\t\t\t\t\t\t\t\t\t'nulla. Aenean dictum lacinia tortor. Nunc iaculis, nibh non iaculis aliquam, orci felis euismod neque, sed ornare massa mauris sed velit. Nulla pretium mi et risus. Fusce mi pede, tempor id, cursus ac, ullamcorper nec, enim. Sed tortor. Curabitur molestie. Duis velit augue, condimentum at, ultrices a, luctus ut, orci. Donec pellentesque egestas eros. Integer cursus, augue in cursus faucibus, eros pede bibendum sem, in tempus tellus justo quis ligula. Etiam eget tortor. Vestibulum rutrum, est ut placerat elementum, lectus nisl aliquam velit, tempor aliquam eros nunc nonummy metus. In eros metus, gravida a, gravida sed, lobortis id, turpis. Ut ultrices, ipsum at venenatis fringilla, sem nulla lacinia tellus, eget aliquet turpis mauris non enim. Nam turpis. Suspendisse lacinia. Curabitur ac tortor ut ipsum egestas elementum. Nunc imperdiet gravida mauris.' ) +\n\t\t\t\t\t\t\t\t\t// jscs:enable maximumLineLength\n\t\t\t\t\t\t\t\t\t'</td></tr></table></div></div>'\n\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t} ]\n\t\t\t\t\t} ]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'Link',\n\t\t\t\t\trequiredContent: 'a[href]',\n\t\t\t\t\tlabel: editor.lang.image.linkTab,\n\t\t\t\t\tpadding: 0,\n\t\t\t\t\telements: [ {\n\t\t\t\t\t\tid: 'txtUrl',\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tlabel: editor.lang.common.url,\n\t\t\t\t\t\tstyle: 'width: 100%',\n\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == LINK ) {\n\t\t\t\t\t\t\t\tvar href = element.data( 'cke-saved-href' );\n\t\t\t\t\t\t\t\tif ( !href )\n\t\t\t\t\t\t\t\t\thref = element.getAttribute( 'href' );\n\t\t\t\t\t\t\t\tthis.setValue( href );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == LINK ) {\n\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() ) {\n\t\t\t\t\t\t\t\t\tvar url = this.getValue();\n\t\t\t\t\t\t\t\t\telement.data( 'cke-saved-href', url );\n\t\t\t\t\t\t\t\t\telement.setAttribute( 'href', url );\n\n\t\t\t\t\t\t\t\t\tif ( this.getValue() || !editor.config.image_removeLinkByEmptyURL )\n\t\t\t\t\t\t\t\t\t\tthis.getDialog().addLink = true;\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t\tthis.getDialog().addLink = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'button',\n\t\t\t\t\t\tid: 'browse',\n\t\t\t\t\t\tclassName: 'cke_dialog_image_browse',\n\t\t\t\t\t\tfilebrowser: {\n\t\t\t\t\t\t\taction: 'Browse',\n\t\t\t\t\t\t\ttarget: 'Link:txtUrl',\n\t\t\t\t\t\t\turl: editor.config.filebrowserImageBrowseLinkUrl\n\t\t\t\t\t\t},\n\t\t\t\t\t\tstyle: 'float:right',\n\t\t\t\t\t\thidden: true,\n\t\t\t\t\t\tlabel: editor.lang.common.browseServer\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'cmbTarget',\n\t\t\t\t\t\ttype: 'select',\n\t\t\t\t\t\trequiredContent: 'a[target]',\n\t\t\t\t\t\tlabel: editor.lang.common.target,\n\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t[ editor.lang.common.notSet, '' ],\n\t\t\t\t\t\t\t[ editor.lang.common.targetNew, '_blank' ],\n\t\t\t\t\t\t\t[ editor.lang.common.targetTop, '_top' ],\n\t\t\t\t\t\t\t[ editor.lang.common.targetSelf, '_self' ],\n\t\t\t\t\t\t\t[ editor.lang.common.targetParent, '_parent' ]\n\t\t\t\t\t\t],\n\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == LINK )\n\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'target' ) || '' );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == LINK ) {\n\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\telement.setAttribute( 'target', this.getValue() );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} ]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'Upload',\n\t\t\t\t\thidden: true,\n\t\t\t\t\tfilebrowser: 'uploadButton',\n\t\t\t\t\tlabel: editor.lang.image.upload,\n\t\t\t\t\telements: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'file',\n\t\t\t\t\t\t\tid: 'upload',\n\t\t\t\t\t\t\tlabel: editor.lang.image.btnUpload,\n\t\t\t\t\t\t\tstyle: 'height:40px',\n\t\t\t\t\t\t\tsize: 38,\n\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\tthis._.buttons[0].fire('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'fileButton',\n\t\t\t\t\t\t\tid: 'uploadButton',\n\t\t\t\t\t\t\tstyle: 'display:none',\n\t\t\t\t\t\t\tfilebrowser: 'info:txtUrl',\n\t\t\t\t\t\t\tlabel: editor.lang.image.btnUpload,\n\t\t\t\t\t\t\t'for': [ 'Upload', 'upload' ]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'advanced',\n\t\t\t\t\tlabel: editor.lang.common.advancedTab,\n\t\t\t\t\telements: [ {\n\t\t\t\t\t\ttype: 'hbox',\n\t\t\t\t\t\twidths: [ '50%', '25%', '25%' ],\n\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\tid: 'linkId',\n\t\t\t\t\t\t\trequiredContent: 'img[id]',\n\t\t\t\t\t\t\tlabel: editor.lang.common.id,\n\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'id' ) );\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\t\telement.setAttribute( 'id', this.getValue() );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'cmbLangDir',\n\t\t\t\t\t\t\ttype: 'select',\n\t\t\t\t\t\t\trequiredContent: 'img[dir]',\n\t\t\t\t\t\t\tstyle: 'width : 100px;',\n\t\t\t\t\t\t\tlabel: editor.lang.common.langDir,\n\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t[ editor.lang.common.notSet, '' ],\n\t\t\t\t\t\t\t\t[ editor.lang.common.langDirLtr, 'ltr' ],\n\t\t\t\t\t\t\t\t[ editor.lang.common.langDirRtl, 'rtl' ]\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'dir' ) );\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\t\telement.setAttribute( 'dir', this.getValue() );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\tid: 'txtLangCode',\n\t\t\t\t\t\t\trequiredContent: 'img[lang]',\n\t\t\t\t\t\t\tlabel: editor.lang.common.langCode,\n\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'lang' ) );\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\t\telement.setAttribute( 'lang', this.getValue() );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} ]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tid: 'txtGenLongDescr',\n\t\t\t\t\t\trequiredContent: 'img[longdesc]',\n\t\t\t\t\t\tlabel: editor.lang.common.longDescr,\n\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'longDesc' ) );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\telement.setAttribute( 'longDesc', this.getValue() );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'hbox',\n\t\t\t\t\t\twidths: [ '50%', '50%' ],\n\t\t\t\t\t\tchildren: [ {\n\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\tid: 'txtGenClass',\n\t\t\t\t\t\t\trequiredContent: 'img(cke-xyz)', // Random text like 'xyz' will check if all are allowed.\n\t\t\t\t\t\t\tlabel: editor.lang.common.cssClass,\n\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'class' ) );\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\t\telement.setAttribute( 'class', this.getValue() );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\tid: 'txtGenTitle',\n\t\t\t\t\t\t\trequiredContent: 'img[title]',\n\t\t\t\t\t\t\tlabel: editor.lang.common.advisoryTitle,\n\t\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\t\tupdatePreview( this.getDialog() );\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE )\n\t\t\t\t\t\t\t\t\tthis.setValue( element.getAttribute( 'title' ) );\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\t\tif ( this.getValue() || this.isChanged() )\n\t\t\t\t\t\t\t\t\t\telement.setAttribute( 'title', this.getValue() );\n\t\t\t\t\t\t\t\t} else if ( type == PREVIEW )\n\t\t\t\t\t\t\t\t\telement.setAttribute( 'title', this.getValue() );\n\t\t\t\t\t\t\t\telse if ( type == CLEANUP ) {\n\t\t\t\t\t\t\t\t\telement.removeAttribute( 'title' );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} ]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\tid: 'txtdlgGenStyle',\n\t\t\t\t\t\trequiredContent: 'img{cke-xyz}', // Random text like 'xyz' will check if all are allowed.\n\t\t\t\t\t\tlabel: editor.lang.common.cssStyle,\n\t\t\t\t\t\tvalidate: CKEDITOR.dialog.validate.inlineStyle( editor.lang.common.invalidInlineStyle ),\n\t\t\t\t\t\t'default': '',\n\t\t\t\t\t\tsetup: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == IMAGE ) {\n\t\t\t\t\t\t\t\tvar genStyle = element.getAttribute( 'style' );\n\t\t\t\t\t\t\t\tif ( !genStyle && element.$.style.cssText )\n\t\t\t\t\t\t\t\t\tgenStyle = element.$.style.cssText;\n\t\t\t\t\t\t\t\tthis.setValue( genStyle );\n\n\t\t\t\t\t\t\t\tvar height = element.$.style.height,\n\t\t\t\t\t\t\t\t\twidth = element.$.style.width,\n\t\t\t\t\t\t\t\t\taMatchH = ( height ? height : '' ).match( regexGetSize ),\n\t\t\t\t\t\t\t\t\taMatchW = ( width ? width : '' ).match( regexGetSize );\n\n\t\t\t\t\t\t\t\tthis.attributesInStyle = {\n\t\t\t\t\t\t\t\t\theight: !!aMatchH,\n\t\t\t\t\t\t\t\t\twidth: !!aMatchW\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonChange: function() {\n\t\t\t\t\t\t\tcommitInternally.call(\n\t\t\t\t\t\t\t\tthis, [\n\t\t\t\t\t\t\t\t\t'info:cmbFloat',\n\t\t\t\t\t\t\t\t\t'info:cmbAlign',\n\t\t\t\t\t\t\t\t\t'info:txtVSpace',\n\t\t\t\t\t\t\t\t\t'info:txtHSpace',\n\t\t\t\t\t\t\t\t\t'info:txtBorder',\n\t\t\t\t\t\t\t\t\t'info:txtWidth',\n\t\t\t\t\t\t\t\t\t'info:txtHeight'\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tupdatePreview( this );\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcommit: function( type, element ) {\n\t\t\t\t\t\t\tif ( type == IMAGE && ( this.getValue() || this.isChanged() ) )\n\t\t\t\t\t\t\t\telement.setAttribute( 'style', this.getValue() );\n\n\t\t\t\t\t\t}\n\t\t\t\t\t} ]\n\t\t\t\t} ]\n\t\t\t};\n\t\t};\n\n\tCKEDITOR.dialog.add( 'image-uf', function( editor ) {\n\t\treturn imageDialog( editor, 'image' );\n\t} );\n\n\tCKEDITOR.dialog.add( 'imagebutton', function( editor ) {\n\t\treturn imageDialog( editor, 'imagebutton' );\n\t} );\n} )();\n"]}